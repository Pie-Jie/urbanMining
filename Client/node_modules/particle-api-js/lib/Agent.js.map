{"version":3,"sources":["../src/Agent.js"],"names":["Agent","baseUrl","prefix","uri","auth","query","context","request","method","data","undefined","form","files","requestFiles","_sanitizeFiles","_request","req","_buildRequest","_promiseResponse","fulfill","reject","_sendRequest","end","error","res","body","url","statusCode","status","errorDescription","shortErrorDescription","error_description","reason","Error","makerequest","use","_authorizationHeader","_applyContext","name","file","options","filepath","path","_inBrowser","attach","value","field","type","send","getXHR","tool","_addToolContext","project","_addProjectContext","_toolIdent","components","component","set","_nameAtVersion","version","_buildSemicolonSeparatedProperties","obj","primaryProperty","prop","hasOwnProperty","username","password","Authorization","forEach","k","i"],"mappings":"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","file":"Agent.js","sourcesContent":["/*\n ******************************************************************************\n Copyright (c) 2016 Particle Industries, Inc.  All rights reserved.\n\n This program is free software; you can redistribute it and/or\n modify it under the terms of the GNU Lesser General Public\n License as published by the Free Software Foundation, either\n version 3 of the License, or (at your option) any later version.\n\n This program is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public\n License along with this program; if not, see <http://www.gnu.org/licenses/>.\n ******************************************************************************\n */\n\nimport request from 'superagent';\nimport prefix from 'superagent-prefix';\n\nexport default class Agent {\n\n\tconstructor(baseUrl) {\n\t\tthis.prefix = prefix(baseUrl);\n\t}\n\n\tget(uri, auth, query, context) {\n\t\treturn this.request({ uri, auth, method: 'get', query, context });\n\t}\n\n\thead(uri, auth, query, context) {\n\t\treturn this.request({ uri, auth, method: 'head', query, context });\n\t}\n\n\tpost(uri, data, auth, context) {\n\t\treturn this.request({ uri, data, auth, method: 'post', context });\n\t}\n\n\tput(uri, data, auth, context) {\n\t\treturn this.request({ uri, data, auth, method: 'put', context });\n\t}\n\n\tdelete(uri, data, auth, context) {\n\t\treturn this.request({ uri, data, auth, method: 'delete', context });\n\t}\n\n\n\t/**\n\t *\n\t * @param {String} uri           The URI to request\n\t * @param {String} method        The method used to request the URI, should be in uppercase.\n\t * @param {String} data          Arbitrary data to send as the body.\n\t * @param {Object} auth          Authorization\n\t * @param {String} query         Query parameters\n\t * @param {Object} form          Form fields\n\t * @param {Object} files         array of file names and file content\n\t * @parma {Object} context       the invocation context, describing the tool and project.\n\t * @return {Promise} A promise. fulfilled with {body, statusCode}, rejected with { statusCode, errorDescription, error, body }\n\t */\n\trequest({ uri, method, data = undefined, auth, query = undefined, form = undefined, files = undefined, context = undefined }) {\n\t\tconst requestFiles = this._sanitizeFiles(files);\n\t\treturn this._request({ uri, method, data, auth, query, form, context, files: requestFiles });\n\t}\n\n\t/**\n\t *\n\t * @param {String} uri           The URI to request\n\t * @param {String} method        The method used to request the URI, should be in uppercase.\n\t * @param {String} data          Arbitrary data to send as the body.\n\t * @param {Object} auth          Authorization\n\t * @param {String} query         Query parameters\n\t * @param {Object} form          Form fields\n\t * @param {Object} files         array of file names and file content\n\t * @param {Object} context       the invocation context\n\t * @return {Promise} A promise. fulfilled with {body, statusCode}, rejected with { statusCode, errorDescription, error, body }\n\t */\n\t_request({ uri, method, data, auth, query, form, files, context }) {\n\t\tconst req = this._buildRequest({ uri, method, data, auth, query, form, context, files });\n\t\treturn this._promiseResponse(req);\n\t}\n\n\t/**\n\t * Promises to send the request and retreive the response.\n\t * @param {Request} req The request to send\n\t * @returns {Promise}   The promise to send the request and retrieve the response.\n\t * @private\n\t */\n\t_promiseResponse(req) {\n\t\treturn new Promise((fulfill, reject) => this._sendRequest(req, fulfill, reject));\n\t}\n\n\t/**\n\t * Sends the given request, calling the fulfill or reject methods for success/failure.\n\t * @param {object} request   The request to send\n\t * @param {function} fulfill    Called on success with the response\n\t * @param {function} reject     Called on failure with the failure reason.\n\t * @private\n\t * @returns {undefined} Nothing\n\t */\n\t_sendRequest(request, fulfill, reject) {\n\t\trequest.end((error, res) => {\n\t\t\tconst body = res && res.body;\n\t\t\tif (error) {\n\t\t\t\tconst uri = request.url;\n\t\t\t\tconst statusCode = error.status;\n\t\t\t\tlet errorDescription = `${statusCode ? 'HTTP error ' + statusCode : 'Network error'} from ${uri}`;\n\t\t\t\tlet shortErrorDescription;\n\t\t\t\tif (body && body.error_description) {\n\t\t\t\t\terrorDescription += ' - ' + body.error_description;\n\t\t\t\t\tshortErrorDescription = body.error_description;\n\t\t\t\t}\n\t\t\t\tconst reason = new Error(errorDescription);\n\t\t\t\tObject.assign(reason, { statusCode, errorDescription, shortErrorDescription, error, body });\n\t\t\t\treject(reason);\n\t\t\t} else {\n\t\t\t\tfulfill({\n\t\t\t\t\tbody: body,\n\t\t\t\t\tstatusCode: res.statusCode\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t_buildRequest({ uri, method, data, auth, query, form, files, context, makerequest=request }) {\n\t\tconst req = makerequest(method, uri);\n\t\tif (this.prefix) {\n\t\t\treq.use(this.prefix);\n\t\t}\n\t\tthis._authorizationHeader(req, auth);\n\t\tif (context) {\n\t\t\tthis._applyContext(req, context);\n\t\t}\n\t\tif (query) {\n\t\t\treq.query(query);\n\t\t}\n\t\tif (files) {\n\t\t\tfor (let [name, file] of Object.entries(files)) {\n\t\t\t\t// API for Form Data is different in Node and in browser\n\t\t\t\tlet options = {\n\t\t\t\t\tfilepath: file.path\n\t\t\t\t};\n\t\t\t\tif (this._inBrowser(makerequest)) {\n\t\t\t\t\toptions = file.path;\n\t\t\t\t}\n\t\t\t\treq.attach(name, file.data, options);\n\t\t\t}\n\t\t\tif (form) {\n\t\t\t\tfor (let [name, value] of Object.entries(form)) {\n\t\t\t\t\treq.field(name, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (form) {\n\t\t\treq.type('form');\n\t\t\treq.send(form);\n\t\t} else if (data) {\n\t\t\treq.send(data);\n\t\t}\n\t\treturn req;\n\t}\n\n\t_inBrowser(makerequest) {\n\t\t// superagent only has the getXHR method in the browser version\n\t\treturn !!makerequest.getXHR;\n\t}\n\n\t_applyContext(req, context) {\n\t\tif (context.tool) {\n\t\t\tthis._addToolContext(req, context.tool);\n\t\t}\n\t\tif (context.project) {\n\t\t\tthis._addProjectContext(req, context.project);\n\t\t}\n\t}\n\n\t_addToolContext(req, tool) {\n\t\tlet value = '';\n\t\tif (tool.name) {\n\t\t\tvalue += this._toolIdent(tool);\n\t\t\tif (tool.components) {\n\t\t\t\tfor (let component of tool.components) {\n\t\t\t\t\tvalue += ', '+this._toolIdent(component);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (value) {\n\t\t\treq.set('X-Particle-Tool', value);\n\t\t}\n\t}\n\n\t_toolIdent(tool) {\n\t\treturn this._nameAtVersion(tool.name, tool.version);\n\t}\n\n\t_nameAtVersion(name, version) {\n\t\tlet value = '';\n\t\tif (name) {\n\t\t\tvalue += name;\n\t\t\tif (version) {\n\t\t\t\tvalue += '@'+version;\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\t_addProjectContext(req, project) {\n\t\tlet value = this._buildSemicolonSeparatedProperties(project, 'name');\n\t\tif (value) {\n\t\t\treq.set('X-Particle-Project', value);\n\t\t}\n\t}\n\n\t/**\n\t * Creates a string like primaryPropertyValue; name=value; name1=value\n\t * from the properties of an object.\n\t * @param {object} obj               The object to create the string from\n\t * @param {string} primaryProperty   The name of the primary property which is the default value and must be defined.\n\t * @private\n\t * @return {string} The formatted string representing the object properties and the default property.\n\t */\n\t_buildSemicolonSeparatedProperties(obj, primaryProperty) {\n\t\tlet value = '';\n\t\tif (obj[primaryProperty]) {\n\t\t\tvalue += obj[primaryProperty];\n\t\t\tfor (let prop in obj) {\n\t\t\t\tif (prop!==primaryProperty && obj.hasOwnProperty(prop)) {\n\t\t\t\t\tvalue += '; '+prop+'='+obj[prop];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\t/**\n\t * Adds an authorization header.\n\t * @param {Request} req     The request to add the authorization header to.\n\t * @param {object|string}  auth    The authorization. Either a string authorization bearer token,\n\t *  or a username/password object.\n\t * @returns {Request} req   The original request.\n\t */\n\t_authorizationHeader(req, auth) {\n\t\tif (auth) {\n\t\t\tif (auth.username !== undefined) {\n\t\t\t\treq.auth(auth.username, auth.password);\n\t\t\t} else {\n\t\t\t\treq.set({ Authorization: `Bearer ${auth}` });\n\t\t\t}\n\t\t}\n\t\treturn req;\n\t}\n\n\t/**\n\t *\n\t * @param {Array} files converts the file names to file, file1, file2.\n\t * @returns {object} the renamed files.\n\t */\n\t_sanitizeFiles(files) {\n\t\tlet requestFiles;\n\t\tif (files) {\n\t\t\trequestFiles = {};\n\t\t\tObject.keys(files).forEach((k, i) => {\n\t\t\t\tconst name = i ? `file${i + 1}` : 'file';\n\t\t\t\trequestFiles[name] = {\n\t\t\t\t\tdata: files[k],\n\t\t\t\t\tpath: k\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t\treturn requestFiles;\n\t}\n}\n\n"]}